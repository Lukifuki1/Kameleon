/**
 * @file Live Web Vulnerability Scanner - Self-Contained Security Assessment Engine
 * @author {{AVTOR}}
 * @version {{VERZIJA}}
 * @date {{DATUM}}
 * @project {{IME_PROJEKTA}}
 * @domain VARNOSTNI_SISTEMI
 * 
 * @requirement REQ-SEC-LVS-001
 * @design DSN-SEC-LVS-001
 * @test TST-SEC-LVS-001
 * 
 * @description
 * Enterprise-grade self-contained live web vulnerability scanner implementing
 * comprehensive security assessment without external API dependencies.
 * All protocols, parsers, and detection algorithms are natively implemented.
 * Supports OWASP Top 10, CWE/SANS Top 25, and custom vulnerability detection.
 * 
 * @classification TOP SECRET - Vulnerability Assessment Operations
 * @authorization Required: Level 5 Security Clearance
 * @dependencies NONE - Fully self-contained implementation
 */

// ═══════════════════════════════════════════════════════════════════════════════
// VULNERABILITY TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export type VulnerabilityCategory =
  | 'INJECTION'
  | 'BROKEN_AUTHENTICATION'
  | 'SENSITIVE_DATA_EXPOSURE'
  | 'XML_EXTERNAL_ENTITIES'
  | 'BROKEN_ACCESS_CONTROL'
  | 'SECURITY_MISCONFIGURATION'
  | 'CROSS_SITE_SCRIPTING'
  | 'INSECURE_DESERIALIZATION'
  | 'VULNERABLE_COMPONENTS'
  | 'INSUFFICIENT_LOGGING'
  | 'SERVER_SIDE_REQUEST_FORGERY'
  | 'CRYPTOGRAPHIC_FAILURES'
  | 'INSECURE_DESIGN'
  | 'SOFTWARE_DATA_INTEGRITY_FAILURES';

export type InjectionType =
  | 'SQL_INJECTION'
  | 'SQL_INJECTION_BLIND'
  | 'SQL_INJECTION_TIME_BASED'
  | 'SQL_INJECTION_ERROR_BASED'
  | 'SQL_INJECTION_UNION_BASED'
  | 'SQL_INJECTION_STACKED'
  | 'NOSQL_INJECTION'
  | 'LDAP_INJECTION'
  | 'XPATH_INJECTION'
  | 'COMMAND_INJECTION'
  | 'OS_COMMAND_INJECTION'
  | 'CODE_INJECTION'
  | 'EXPRESSION_LANGUAGE_INJECTION'
  | 'TEMPLATE_INJECTION'
  | 'SSTI'
  | 'HEADER_INJECTION'
  | 'HOST_HEADER_INJECTION'
  | 'EMAIL_HEADER_INJECTION'
  | 'LOG_INJECTION'
  | 'CRLF_INJECTION'
  | 'CSV_INJECTION'
  | 'FORMULA_INJECTION';

export type XSSType =
  | 'XSS_REFLECTED'
  | 'XSS_STORED'
  | 'XSS_DOM_BASED'
  | 'XSS_MUTATION'
  | 'XSS_BLIND'
  | 'XSS_SELF'
  | 'XSS_UNIVERSAL';

export type AuthenticationVulnerability =
  | 'WEAK_PASSWORD_POLICY'
  | 'CREDENTIAL_STUFFING'
  | 'BRUTE_FORCE'
  | 'DEFAULT_CREDENTIALS'
  | 'SESSION_FIXATION'
  | 'SESSION_HIJACKING'
  | 'INSECURE_SESSION_MANAGEMENT'
  | 'MISSING_MFA'
  | 'WEAK_TOKEN_GENERATION'
  | 'PASSWORD_RESET_POISONING'
  | 'ACCOUNT_ENUMERATION'
  | 'TIMING_ATTACK'
  | 'JWT_VULNERABILITIES'
  | 'OAUTH_VULNERABILITIES';

export type AccessControlVulnerability =
  | 'IDOR'
  | 'PRIVILEGE_ESCALATION'
  | 'HORIZONTAL_PRIVILEGE_ESCALATION'
  | 'VERTICAL_PRIVILEGE_ESCALATION'
  | 'FORCED_BROWSING'
  | 'DIRECTORY_TRAVERSAL'
  | 'PATH_TRAVERSAL'
  | 'FILE_INCLUSION_LOCAL'
  | 'FILE_INCLUSION_REMOTE'
  | 'MISSING_FUNCTION_LEVEL_ACCESS_CONTROL'
  | 'CORS_MISCONFIGURATION'
  | 'METADATA_MANIPULATION'
  | 'JWT_BYPASS';

export type SSRFType =
  | 'SSRF_BASIC'
  | 'SSRF_BLIND'
  | 'SSRF_PARTIAL'
  | 'SSRF_FULL'
  | 'SSRF_PROTOCOL_SMUGGLING'
  | 'SSRF_DNS_REBINDING'
  | 'SSRF_CLOUD_METADATA';

export type MisconfigurationType =
  | 'DEBUG_ENABLED'
  | 'VERBOSE_ERRORS'
  | 'DIRECTORY_LISTING'
  | 'DEFAULT_PAGES'
  | 'BACKUP_FILES'
  | 'SOURCE_CODE_DISCLOSURE'
  | 'INFORMATION_DISCLOSURE'
  | 'MISSING_SECURITY_HEADERS'
  | 'INSECURE_HTTP_METHODS'
  | 'CORS_WILDCARD'
  | 'CLICKJACKING'
  | 'MIME_SNIFFING'
  | 'CACHE_POISONING'
  | 'HTTP_REQUEST_SMUGGLING'
  | 'HTTP_RESPONSE_SPLITTING'
  | 'OPEN_REDIRECT'
  | 'SUBDOMAIN_TAKEOVER';

export type CryptographicVulnerability =
  | 'WEAK_SSL_TLS'
  | 'EXPIRED_CERTIFICATE'
  | 'SELF_SIGNED_CERTIFICATE'
  | 'CERTIFICATE_MISMATCH'
  | 'WEAK_CIPHER_SUITES'
  | 'INSECURE_PROTOCOL'
  | 'MISSING_HSTS'
  | 'WEAK_HASHING'
  | 'HARDCODED_SECRETS'
  | 'INSECURE_RANDOM'
  | 'PADDING_ORACLE'
  | 'BEAST'
  | 'POODLE'
  | 'HEARTBLEED'
  | 'DROWN'
  | 'ROBOT'
  | 'SWEET32'
  | 'LUCKY13'
  | 'CRIME'
  | 'BREACH'
  | 'LOGJAM'
  | 'FREAK';

export type SeverityLevel =
  | 'CRITICAL'
  | 'HIGH'
  | 'MEDIUM'
  | 'LOW'
  | 'INFORMATIONAL';

export type ConfidenceLevel =
  | 'CONFIRMED'
  | 'HIGH'
  | 'MEDIUM'
  | 'LOW'
  | 'TENTATIVE';

export type ScanStatus =
  | 'PENDING'
  | 'INITIALIZING'
  | 'CRAWLING'
  | 'SCANNING'
  | 'ANALYZING'
  | 'COMPLETED'
  | 'PAUSED'
  | 'CANCELLED'
  | 'FAILED';

export type ScanMode =
  | 'PASSIVE'
  | 'ACTIVE'
  | 'AGGRESSIVE'
  | 'STEALTH'
  | 'CUSTOM';

export type TargetType =
  | 'WEB_APPLICATION'
  | 'REST_API'
  | 'GRAPHQL_API'
  | 'SOAP_API'
  | 'WEBSOCKET'
  | 'GRPC'
  | 'SINGLE_PAGE_APPLICATION'
  | 'MOBILE_BACKEND';

// ═══════════════════════════════════════════════════════════════════════════════
// SCANNER CONFIGURATION
// ═══════════════════════════════════════════════════════════════════════════════

export interface LiveScannerConfig {
  readonly scannerId: string;
  readonly name: string;
  readonly version: string;
  readonly target: TargetConfig;
  readonly scope: ScopeConfig;
  readonly authentication: AuthenticationConfig | null;
  readonly crawling: CrawlingConfig;
  readonly scanning: ScanningConfig;
  readonly detection: DetectionConfig;
  readonly reporting: ReportingConfig;
  readonly performance: PerformanceConfig;
  readonly stealth: StealthScanConfig;
  readonly scheduling: SchedulingConfig;
  readonly notifications: NotificationConfig;
  readonly metadata: ScannerMetadata;
}

export interface TargetConfig {
  readonly url: string;
  readonly type: TargetType;
  readonly protocol: 'HTTP' | 'HTTPS' | 'BOTH';
  readonly port: number;
  readonly basePath: string;
  readonly virtualHost: string | null;
  readonly ipAddress: string | null;
  readonly technology: TechnologyStack | null;
}

export interface TechnologyStack {
  readonly webServer: string | null;
  readonly applicationServer: string | null;
  readonly framework: string | null;
  readonly language: string | null;
  readonly database: string | null;
  readonly cms: string | null;
  readonly waf: string | null;
  readonly cdn: string | null;
  readonly loadBalancer: string | null;
}

export interface ScopeConfig {
  readonly includePaths: readonly string[];
  readonly excludePaths: readonly string[];
  readonly includeParameters: readonly string[];
  readonly excludeParameters: readonly string[];
  readonly includeExtensions: readonly string[];
  readonly excludeExtensions: readonly string[];
  readonly includeSubdomains: boolean;
  readonly maxDepth: number;
  readonly maxUrls: number;
  readonly followRedirects: boolean;
  readonly maxRedirects: number;
  readonly respectRobotsTxt: boolean;
  readonly respectMetaRobots: boolean;
}

export interface AuthenticationConfig {
  readonly type: AuthenticationType;
  readonly credentials: CredentialsConfig;
  readonly session: SessionConfig;
  readonly loginSequence: LoginSequence | null;
  readonly logoutDetection: LogoutDetection;
  readonly reauthentication: ReauthenticationConfig;
}

export type AuthenticationType =
  | 'NONE'
  | 'BASIC'
  | 'DIGEST'
  | 'NTLM'
  | 'FORM'
  | 'BEARER'
  | 'API_KEY'
  | 'OAUTH2'
  | 'SAML'
  | 'CERTIFICATE'
  | 'CUSTOM';

export interface CredentialsConfig {
  readonly username: string | null;
  readonly password: string | null;
  readonly token: string | null;
  readonly apiKey: string | null;
  readonly certificate: CertificateConfig | null;
  readonly customHeaders: Readonly<Record<string, string>>;
}

export interface CertificateConfig {
  readonly certificate: string;
  readonly privateKey: string;
  readonly passphrase: string | null;
  readonly ca: string | null;
}

export interface SessionConfig {
  readonly cookieName: string | null;
  readonly headerName: string | null;
  readonly parameterName: string | null;
  readonly tokenLocation: 'COOKIE' | 'HEADER' | 'BODY' | 'URL';
  readonly tokenExtraction: TokenExtractionConfig | null;
}

export interface TokenExtractionConfig {
  readonly method: 'REGEX' | 'XPATH' | 'CSS_SELECTOR' | 'JSON_PATH';
  readonly pattern: string;
  readonly source: 'RESPONSE_BODY' | 'RESPONSE_HEADER' | 'COOKIE';
}

export interface LoginSequence {
  readonly steps: readonly LoginStep[];
  readonly successIndicator: SuccessIndicator;
  readonly failureIndicator: FailureIndicator;
}

export interface LoginStep {
  readonly stepId: string;
  readonly method: 'GET' | 'POST' | 'PUT';
  readonly url: string;
  readonly headers: Readonly<Record<string, string>>;
  readonly body: string | null;
  readonly contentType: string | null;
  readonly extractTokens: readonly TokenExtractionConfig[];
  readonly waitTime: number;
}

export interface SuccessIndicator {
  readonly type: 'STATUS_CODE' | 'RESPONSE_BODY' | 'HEADER' | 'REDIRECT' | 'COOKIE';
  readonly pattern: string;
  readonly negate: boolean;
}

export interface FailureIndicator {
  readonly type: 'STATUS_CODE' | 'RESPONSE_BODY' | 'HEADER' | 'REDIRECT';
  readonly pattern: string;
}

export interface LogoutDetection {
  readonly enabled: boolean;
  readonly indicators: readonly LogoutIndicator[];
}

export interface LogoutIndicator {
  readonly type: 'STATUS_CODE' | 'RESPONSE_BODY' | 'HEADER' | 'REDIRECT' | 'COOKIE_REMOVAL';
  readonly pattern: string;
}

export interface ReauthenticationConfig {
  readonly enabled: boolean;
  readonly maxAttempts: number;
  readonly delayBetweenAttempts: number;
  readonly triggerOnLogout: boolean;
  readonly triggerOnError: boolean;
}

export interface CrawlingConfig {
  readonly enabled: boolean;
  readonly mode: CrawlingMode;
  readonly maxPages: number;
  readonly maxDepth: number;
  readonly maxDuration: number;
  readonly requestDelay: number;
  readonly requestTimeout: number;
  readonly concurrentRequests: number;
  readonly userAgent: string;
  readonly customHeaders: Readonly<Record<string, string>>;
  readonly formHandling: FormHandlingConfig;
  readonly ajaxHandling: AjaxHandlingConfig;
  readonly linkExtraction: LinkExtractionConfig;
  readonly parameterDiscovery: ParameterDiscoveryConfig;
}

export type CrawlingMode =
  | 'BREADTH_FIRST'
  | 'DEPTH_FIRST'
  | 'SMART'
  | 'TARGETED';

export interface FormHandlingConfig {
  readonly enabled: boolean;
  readonly autoFill: boolean;
  readonly submitForms: boolean;
  readonly defaultValues: Readonly<Record<string, string>>;
  readonly skipPatterns: readonly string[];
}

export interface AjaxHandlingConfig {
  readonly enabled: boolean;
  readonly waitForAjax: boolean;
  readonly maxWaitTime: number;
  readonly interceptXhr: boolean;
  readonly interceptFetch: boolean;
}

export interface LinkExtractionConfig {
  readonly extractFromHtml: boolean;
  readonly extractFromJavascript: boolean;
  readonly extractFromCss: boolean;
  readonly extractFromComments: boolean;
  readonly extractFromRobotsTxt: boolean;
  readonly extractFromSitemap: boolean;
  readonly customPatterns: readonly string[];
}

export interface ParameterDiscoveryConfig {
  readonly enabled: boolean;
  readonly discoverHiddenParams: boolean;
  readonly discoverFromJs: boolean;
  readonly commonParamWordlist: readonly string[];
  readonly maxParamsPerEndpoint: number;
}

export interface ScanningConfig {
  readonly mode: ScanMode;
  readonly modules: readonly ScanModuleConfig[];
  readonly payloads: PayloadConfig;
  readonly fuzzing: FuzzingConfig;
  readonly requestConfig: RequestConfig;
  readonly responseAnalysis: ResponseAnalysisConfig;
  readonly errorHandling: ErrorHandlingConfig;
}

export interface ScanModuleConfig {
  readonly moduleId: string;
  readonly name: string;
  readonly enabled: boolean;
  readonly category: VulnerabilityCategory;
  readonly priority: number;
  readonly timeout: number;
  readonly maxRequests: number;
  readonly customConfig: Readonly<Record<string, unknown>>;
}

export interface PayloadConfig {
  readonly encoding: readonly PayloadEncoding[];
  readonly evasion: readonly EvasionTechnique[];
  readonly mutation: MutationConfig;
  readonly customPayloads: Readonly<Record<string, readonly string[]>>;
}

export type PayloadEncoding =
  | 'NONE'
  | 'URL'
  | 'DOUBLE_URL'
  | 'HTML'
  | 'BASE64'
  | 'HEX'
  | 'UNICODE'
  | 'UTF7'
  | 'MIXED_CASE'
  | 'NULL_BYTE'
  | 'BACKSLASH';

export type EvasionTechnique =
  | 'CASE_VARIATION'
  | 'COMMENT_INJECTION'
  | 'WHITESPACE_VARIATION'
  | 'ENCODING_VARIATION'
  | 'CONCATENATION'
  | 'ALTERNATIVE_SYNTAX'
  | 'DOUBLE_ENCODING'
  | 'UNICODE_NORMALIZATION'
  | 'NULL_BYTE_INJECTION'
  | 'PARAMETER_POLLUTION';

export interface MutationConfig {
  readonly enabled: boolean;
  readonly maxMutations: number;
  readonly mutationTypes: readonly MutationType[];
}

export type MutationType =
  | 'CASE_SWAP'
  | 'CHAR_SUBSTITUTION'
  | 'CHAR_INSERTION'
  | 'CHAR_DELETION'
  | 'ENCODING_SWAP'
  | 'BOUNDARY_EXTENSION'
  | 'FORMAT_STRING';

export interface FuzzingConfig {
  readonly enabled: boolean;
  readonly mode: FuzzingMode;
  readonly maxIterations: number;
  readonly timeout: number;
  readonly seedCorpus: readonly string[];
  readonly dictionary: readonly string[];
  readonly coverage: CoverageConfig;
}

export type FuzzingMode =
  | 'RANDOM'
  | 'MUTATION'
  | 'GENERATION'
  | 'GRAMMAR'
  | 'COVERAGE_GUIDED';

export interface CoverageConfig {
  readonly enabled: boolean;
  readonly trackCodePaths: boolean;
  readonly trackResponseVariations: boolean;
  readonly minimizeCorpus: boolean;
}

export interface RequestConfig {
  readonly timeout: number;
  readonly retries: number;
  readonly retryDelay: number;
  readonly followRedirects: boolean;
  readonly maxRedirects: number;
  readonly validateCertificates: boolean;
  readonly proxy: ProxyConfig | null;
  readonly rateLimit: RateLimitConfig;
}

export interface ProxyConfig {
  readonly host: string;
  readonly port: number;
  readonly protocol: 'HTTP' | 'HTTPS' | 'SOCKS4' | 'SOCKS5';
  readonly username: string | null;
  readonly password: string | null;
}

export interface RateLimitConfig {
  readonly enabled: boolean;
  readonly requestsPerSecond: number;
  readonly burstSize: number;
  readonly adaptiveThrottling: boolean;
  readonly backoffMultiplier: number;
  readonly maxBackoff: number;
}

export interface ResponseAnalysisConfig {
  readonly analyzeHeaders: boolean;
  readonly analyzeBody: boolean;
  readonly analyzeTiming: boolean;
  readonly analyzeErrors: boolean;
  readonly diffAnalysis: boolean;
  readonly contentAnalysis: ContentAnalysisConfig;
}

export interface ContentAnalysisConfig {
  readonly detectSensitiveData: boolean;
  readonly detectSecrets: boolean;
  readonly detectPii: boolean;
  readonly detectStackTraces: boolean;
  readonly detectDebugInfo: boolean;
  readonly customPatterns: readonly ContentPattern[];
}

export interface ContentPattern {
  readonly patternId: string;
  readonly name: string;
  readonly regex: string;
  readonly severity: SeverityLevel;
  readonly description: string;
}

export interface ErrorHandlingConfig {
  readonly retryOnError: boolean;
  readonly maxRetries: number;
  readonly retryDelay: number;
  readonly skipOnPersistentError: boolean;
  readonly logErrors: boolean;
  readonly alertOnCriticalError: boolean;
}

export interface DetectionConfig {
  readonly techniques: readonly DetectionTechnique[];
  readonly signatures: readonly VulnerabilitySignature[];
  readonly heuristics: readonly HeuristicRule[];
  readonly correlation: CorrelationConfig;
  readonly falsePositiveReduction: FalsePositiveConfig;
}

export type DetectionTechnique =
  | 'SIGNATURE_BASED'
  | 'HEURISTIC_BASED'
  | 'BEHAVIORAL'
  | 'DIFFERENTIAL'
  | 'TIME_BASED'
  | 'ERROR_BASED'
  | 'OUT_OF_BAND'
  | 'BLIND';

export interface VulnerabilitySignature {
  readonly signatureId: string;
  readonly name: string;
  readonly category: VulnerabilityCategory;
  readonly severity: SeverityLevel;
  readonly pattern: SignaturePattern;
  readonly conditions: readonly SignatureCondition[];
  readonly falsePositiveIndicators: readonly string[];
  readonly references: readonly string[];
}

export interface SignaturePattern {
  readonly type: 'REGEX' | 'LITERAL' | 'XPATH' | 'CSS_SELECTOR' | 'JSON_PATH';
  readonly value: string;
  readonly location: 'REQUEST' | 'RESPONSE_BODY' | 'RESPONSE_HEADER' | 'STATUS_CODE' | 'TIMING';
  readonly caseSensitive: boolean;
}

export interface SignatureCondition {
  readonly type: 'AND' | 'OR' | 'NOT';
  readonly conditions: readonly SignaturePattern[];
}

export interface HeuristicRule {
  readonly ruleId: string;
  readonly name: string;
  readonly category: VulnerabilityCategory;
  readonly severity: SeverityLevel;
  readonly logic: HeuristicLogic;
  readonly threshold: number;
  readonly weight: number;
}

export interface HeuristicLogic {
  readonly type: 'SCORE' | 'THRESHOLD' | 'ANOMALY' | 'STATISTICAL';
  readonly parameters: Readonly<Record<string, unknown>>;
}

export interface CorrelationConfig {
  readonly enabled: boolean;
  readonly correlateAcrossEndpoints: boolean;
  readonly correlateAcrossParameters: boolean;
  readonly correlateAcrossVulnerabilities: boolean;
  readonly timeWindow: number;
}

export interface FalsePositiveConfig {
  readonly enabled: boolean;
  readonly verificationRequests: number;
  readonly confidenceThreshold: number;
  readonly knownFalsePositives: readonly string[];
  readonly contextualAnalysis: boolean;
}

export interface ReportingConfig {
  readonly formats: readonly ReportFormat[];
  readonly includeEvidence: boolean;
  readonly includeRemediation: boolean;
  readonly includeReferences: boolean;
  readonly includeTimeline: boolean;
  readonly includeStatistics: boolean;
  readonly groupBy: 'SEVERITY' | 'CATEGORY' | 'ENDPOINT' | 'PARAMETER';
  readonly sortBy: 'SEVERITY' | 'CONFIDENCE' | 'TIMESTAMP';
  readonly customTemplate: string | null;
}

export type ReportFormat =
  | 'HTML'
  | 'PDF'
  | 'JSON'
  | 'XML'
  | 'CSV'
  | 'MARKDOWN'
  | 'SARIF'
  | 'JUNIT';

export interface PerformanceConfig {
  readonly maxConcurrentScans: number;
  readonly maxConcurrentRequests: number;
  readonly maxMemoryUsage: number;
  readonly maxCpuUsage: number;
  readonly requestQueueSize: number;
  readonly resultCacheSize: number;
  readonly enableCompression: boolean;
  readonly enableConnectionPooling: boolean;
  readonly connectionPoolSize: number;
}

export interface StealthScanConfig {
  readonly enabled: boolean;
  readonly mode: StealthMode;
  readonly userAgentRotation: boolean;
  readonly userAgents: readonly string[];
  readonly ipRotation: boolean;
  readonly proxyRotation: boolean;
  readonly proxies: readonly ProxyConfig[];
  readonly requestJitter: JitterConfig;
  readonly headerRandomization: boolean;
  readonly fingerprintEvasion: boolean;
  readonly wafEvasion: WAFEvasionConfig;
}

export type StealthMode =
  | 'NORMAL'
  | 'LOW_PROFILE'
  | 'COVERT'
  | 'PARANOID';

export interface JitterConfig {
  readonly enabled: boolean;
  readonly minDelay: number;
  readonly maxDelay: number;
  readonly distribution: 'UNIFORM' | 'GAUSSIAN' | 'EXPONENTIAL';
}

export interface WAFEvasionConfig {
  readonly enabled: boolean;
  readonly techniques: readonly WAFEvasionTechnique[];
  readonly adaptiveEvasion: boolean;
  readonly wafFingerprinting: boolean;
}

export type WAFEvasionTechnique =
  | 'ENCODING_BYPASS'
  | 'CASE_MANIPULATION'
  | 'COMMENT_INJECTION'
  | 'WHITESPACE_MANIPULATION'
  | 'PARAMETER_POLLUTION'
  | 'CHUNKED_ENCODING'
  | 'CONTENT_TYPE_MANIPULATION'
  | 'HTTP_METHOD_OVERRIDE'
  | 'PROTOCOL_LEVEL_EVASION';

export interface SchedulingConfig {
  readonly enabled: boolean;
  readonly schedule: ScheduleConfig | null;
  readonly recurring: RecurringConfig | null;
  readonly blackoutPeriods: readonly BlackoutPeriod[];
}

export interface ScheduleConfig {
  readonly startTime: number;
  readonly endTime: number | null;
  readonly timezone: string;
}

export interface RecurringConfig {
  readonly frequency: 'HOURLY' | 'DAILY' | 'WEEKLY' | 'MONTHLY';
  readonly interval: number;
  readonly daysOfWeek: readonly number[];
  readonly daysOfMonth: readonly number[];
  readonly time: string;
}

export interface BlackoutPeriod {
  readonly periodId: string;
  readonly name: string;
  readonly startTime: string;
  readonly endTime: string;
  readonly daysOfWeek: readonly number[];
  readonly reason: string;
}

export interface NotificationConfig {
  readonly enabled: boolean;
  readonly channels: readonly NotificationChannel[];
  readonly triggers: readonly NotificationTrigger[];
  readonly throttling: ThrottlingConfig;
}

export interface NotificationChannel {
  readonly channelId: string;
  readonly type: 'EMAIL' | 'WEBHOOK' | 'SLACK' | 'TEAMS' | 'SYSLOG' | 'CUSTOM';
  readonly config: Readonly<Record<string, unknown>>;
  readonly enabled: boolean;
}

export interface NotificationTrigger {
  readonly triggerId: string;
  readonly event: NotificationEvent;
  readonly severity: SeverityLevel | null;
  readonly channels: readonly string[];
}

export type NotificationEvent =
  | 'SCAN_STARTED'
  | 'SCAN_COMPLETED'
  | 'SCAN_FAILED'
  | 'VULNERABILITY_FOUND'
  | 'CRITICAL_VULNERABILITY'
  | 'SCAN_PROGRESS';

export interface ThrottlingConfig {
  readonly enabled: boolean;
  readonly maxNotificationsPerHour: number;
  readonly aggregationWindow: number;
}

export interface ScannerMetadata {
  readonly createdAt: number;
  readonly updatedAt: number;
  readonly createdBy: string;
  readonly version: string;
  readonly tags: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// SCAN RESULT TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface ScanResult {
  readonly scanId: string;
  readonly scannerId: string;
  readonly target: TargetConfig;
  readonly status: ScanStatus;
  readonly startTime: number;
  readonly endTime: number | null;
  readonly duration: number | null;
  readonly progress: ScanProgress;
  readonly statistics: ScanStatistics;
  readonly vulnerabilities: readonly Vulnerability[];
  readonly crawlResults: CrawlResults;
  readonly errors: readonly ScanError[];
  readonly metadata: ScanResultMetadata;
}

export interface ScanProgress {
  readonly phase: ScanPhase;
  readonly percentage: number;
  readonly currentUrl: string | null;
  readonly currentModule: string | null;
  readonly urlsScanned: number;
  readonly urlsRemaining: number;
  readonly requestsSent: number;
  readonly vulnerabilitiesFound: number;
}

export type ScanPhase =
  | 'INITIALIZING'
  | 'AUTHENTICATION'
  | 'CRAWLING'
  | 'FINGERPRINTING'
  | 'SCANNING'
  | 'VERIFICATION'
  | 'REPORTING'
  | 'COMPLETED';

export interface ScanStatistics {
  readonly totalUrls: number;
  readonly scannedUrls: number;
  readonly totalRequests: number;
  readonly totalResponses: number;
  readonly totalErrors: number;
  readonly totalVulnerabilities: number;
  readonly criticalVulnerabilities: number;
  readonly highVulnerabilities: number;
  readonly mediumVulnerabilities: number;
  readonly lowVulnerabilities: number;
  readonly informationalFindings: number;
  readonly averageResponseTime: number;
  readonly maxResponseTime: number;
  readonly minResponseTime: number;
  readonly bytesTransferred: number;
  readonly uniqueParameters: number;
  readonly uniqueForms: number;
  readonly uniqueEndpoints: number;
}

export interface Vulnerability {
  readonly vulnerabilityId: string;
  readonly scanId: string;
  readonly category: VulnerabilityCategory;
  readonly type: string;
  readonly name: string;
  readonly description: string;
  readonly severity: SeverityLevel;
  readonly confidence: ConfidenceLevel;
  readonly cvssScore: number | null;
  readonly cvssVector: string | null;
  readonly cweId: string | null;
  readonly cveId: string | null;
  readonly owaspCategory: string | null;
  readonly location: VulnerabilityLocation;
  readonly evidence: VulnerabilityEvidence;
  readonly impact: VulnerabilityImpact;
  readonly remediation: VulnerabilityRemediation;
  readonly references: readonly VulnerabilityReference[];
  readonly timeline: VulnerabilityTimeline;
  readonly status: VulnerabilityStatus;
  readonly tags: readonly string[];
}

export interface VulnerabilityLocation {
  readonly url: string;
  readonly method: string;
  readonly parameter: string | null;
  readonly parameterType: 'QUERY' | 'BODY' | 'HEADER' | 'COOKIE' | 'PATH' | 'FRAGMENT';
  readonly path: string;
  readonly lineNumber: number | null;
  readonly columnNumber: number | null;
  readonly codeSnippet: string | null;
}

export interface VulnerabilityEvidence {
  readonly request: HTTPRequest;
  readonly response: HTTPResponse;
  readonly payload: string | null;
  readonly matchedPattern: string | null;
  readonly screenshot: string | null;
  readonly additionalEvidence: readonly EvidenceItem[];
}

export interface HTTPRequest {
  readonly method: string;
  readonly url: string;
  readonly headers: Readonly<Record<string, string>>;
  readonly body: string | null;
  readonly timestamp: number;
}

export interface HTTPResponse {
  readonly statusCode: number;
  readonly statusMessage: string;
  readonly headers: Readonly<Record<string, string>>;
  readonly body: string | null;
  readonly bodyLength: number;
  readonly responseTime: number;
  readonly timestamp: number;
}

export interface EvidenceItem {
  readonly type: 'TEXT' | 'IMAGE' | 'VIDEO' | 'FILE' | 'LOG';
  readonly name: string;
  readonly content: string;
  readonly mimeType: string;
}

export interface VulnerabilityImpact {
  readonly confidentiality: 'NONE' | 'LOW' | 'HIGH';
  readonly integrity: 'NONE' | 'LOW' | 'HIGH';
  readonly availability: 'NONE' | 'LOW' | 'HIGH';
  readonly scope: 'UNCHANGED' | 'CHANGED';
  readonly description: string;
  readonly businessImpact: string | null;
}

export interface VulnerabilityRemediation {
  readonly description: string;
  readonly steps: readonly RemediationStep[];
  readonly codeExample: string | null;
  readonly estimatedEffort: 'LOW' | 'MEDIUM' | 'HIGH';
  readonly priority: 'IMMEDIATE' | 'SHORT_TERM' | 'LONG_TERM';
}

export interface RemediationStep {
  readonly stepNumber: number;
  readonly description: string;
  readonly codeSnippet: string | null;
}

export interface VulnerabilityReference {
  readonly type: 'CWE' | 'CVE' | 'OWASP' | 'NIST' | 'ARTICLE' | 'DOCUMENTATION' | 'TOOL';
  readonly title: string;
  readonly url: string;
}

export interface VulnerabilityTimeline {
  readonly discoveredAt: number;
  readonly verifiedAt: number | null;
  readonly reportedAt: number | null;
  readonly acknowledgedAt: number | null;
  readonly resolvedAt: number | null;
}

export type VulnerabilityStatus =
  | 'NEW'
  | 'CONFIRMED'
  | 'FALSE_POSITIVE'
  | 'ACCEPTED_RISK'
  | 'IN_PROGRESS'
  | 'RESOLVED'
  | 'REOPENED';

export interface CrawlResults {
  readonly urls: readonly CrawledUrl[];
  readonly forms: readonly CrawledForm[];
  readonly parameters: readonly DiscoveredParameter[];
  readonly technologies: TechnologyFingerprint;
  readonly sitemapUrls: readonly string[];
  readonly robotsTxtRules: RobotsTxtRules | null;
}

export interface CrawledUrl {
  readonly url: string;
  readonly method: string;
  readonly statusCode: number;
  readonly contentType: string;
  readonly contentLength: number;
  readonly responseTime: number;
  readonly depth: number;
  readonly parent: string | null;
  readonly outLinks: readonly string[];
  readonly inLinks: readonly string[];
  readonly parameters: readonly string[];
  readonly timestamp: number;
}

export interface CrawledForm {
  readonly formId: string;
  readonly url: string;
  readonly action: string;
  readonly method: string;
  readonly enctype: string;
  readonly fields: readonly FormField[];
  readonly hasFileUpload: boolean;
  readonly hasCsrfToken: boolean;
}

export interface FormField {
  readonly name: string;
  readonly type: string;
  readonly value: string | null;
  readonly required: boolean;
  readonly maxLength: number | null;
  readonly pattern: string | null;
  readonly options: readonly string[] | null;
}

export interface DiscoveredParameter {
  readonly name: string;
  readonly type: 'QUERY' | 'BODY' | 'HEADER' | 'COOKIE' | 'PATH';
  readonly urls: readonly string[];
  readonly values: readonly string[];
  readonly dataType: 'STRING' | 'NUMBER' | 'BOOLEAN' | 'ARRAY' | 'OBJECT' | 'UNKNOWN';
  readonly sensitive: boolean;
}

export interface TechnologyFingerprint {
  readonly webServer: TechnologyInfo | null;
  readonly applicationServer: TechnologyInfo | null;
  readonly framework: TechnologyInfo | null;
  readonly language: TechnologyInfo | null;
  readonly database: TechnologyInfo | null;
  readonly cms: TechnologyInfo | null;
  readonly waf: TechnologyInfo | null;
  readonly cdn: TechnologyInfo | null;
  readonly analytics: readonly TechnologyInfo[];
  readonly javascript: readonly TechnologyInfo[];
  readonly css: readonly TechnologyInfo[];
  readonly other: readonly TechnologyInfo[];
}

export interface TechnologyInfo {
  readonly name: string;
  readonly version: string | null;
  readonly confidence: number;
  readonly categories: readonly string[];
  readonly cpe: string | null;
  readonly website: string | null;
}

export interface RobotsTxtRules {
  readonly userAgents: readonly RobotsTxtUserAgent[];
  readonly sitemaps: readonly string[];
  readonly crawlDelay: number | null;
}

export interface RobotsTxtUserAgent {
  readonly userAgent: string;
  readonly allow: readonly string[];
  readonly disallow: readonly string[];
}

export interface ScanError {
  readonly errorId: string;
  readonly timestamp: number;
  readonly type: ScanErrorType;
  readonly message: string;
  readonly url: string | null;
  readonly module: string | null;
  readonly stackTrace: string | null;
  readonly recoverable: boolean;
}

export type ScanErrorType =
  | 'CONNECTION_ERROR'
  | 'TIMEOUT'
  | 'SSL_ERROR'
  | 'AUTHENTICATION_ERROR'
  | 'RATE_LIMIT'
  | 'WAF_BLOCK'
  | 'PARSE_ERROR'
  | 'CONFIGURATION_ERROR'
  | 'INTERNAL_ERROR';

export interface ScanResultMetadata {
  readonly scannerVersion: string;
  readonly signatureVersion: string;
  readonly engineVersion: string;
  readonly startedBy: string;
  readonly environment: string;
  readonly tags: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// NATIVE HTTP IMPLEMENTATION TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface NativeHTTPClient {
  readonly clientId: string;
  readonly config: NativeHTTPConfig;
  readonly connectionPool: ConnectionPool;
  readonly cookieJar: CookieJar;
  readonly requestInterceptors: readonly RequestInterceptor[];
  readonly responseInterceptors: readonly ResponseInterceptor[];
}

export interface NativeHTTPConfig {
  readonly timeout: number;
  readonly keepAlive: boolean;
  readonly keepAliveTimeout: number;
  readonly maxSockets: number;
  readonly maxFreeSockets: number;
  readonly socketTimeout: number;
  readonly dnsCache: boolean;
  readonly dnsCacheTtl: number;
  readonly tcpNoDelay: boolean;
  readonly rejectUnauthorized: boolean;
  readonly secureProtocol: string;
  readonly ciphers: string;
  readonly honorCipherOrder: boolean;
}

export interface ConnectionPool {
  readonly maxConnections: number;
  readonly maxConnectionsPerHost: number;
  readonly connectionTimeout: number;
  readonly idleTimeout: number;
  readonly connections: readonly PooledConnection[];
}

export interface PooledConnection {
  readonly connectionId: string;
  readonly host: string;
  readonly port: number;
  readonly protocol: 'HTTP' | 'HTTPS';
  readonly state: 'IDLE' | 'ACTIVE' | 'CLOSED';
  readonly createdAt: number;
  readonly lastUsedAt: number;
  readonly requestCount: number;
}

export interface CookieJar {
  readonly cookies: readonly Cookie[];
  readonly maxCookies: number;
  readonly maxCookiesPerDomain: number;
}

export interface Cookie {
  readonly name: string;
  readonly value: string;
  readonly domain: string;
  readonly path: string;
  readonly expires: number | null;
  readonly maxAge: number | null;
  readonly secure: boolean;
  readonly httpOnly: boolean;
  readonly sameSite: 'STRICT' | 'LAX' | 'NONE' | null;
}

export interface RequestInterceptor {
  readonly interceptorId: string;
  readonly name: string;
  readonly priority: number;
  readonly enabled: boolean;
}

export interface ResponseInterceptor {
  readonly interceptorId: string;
  readonly name: string;
  readonly priority: number;
  readonly enabled: boolean;
}

// ═══════════════════════════════════════════════════════════════════════════════
// NATIVE HTML PARSER TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface NativeHTMLParser {
  readonly parserId: string;
  readonly config: HTMLParserConfig;
}

export interface HTMLParserConfig {
  readonly strictMode: boolean;
  readonly decodeEntities: boolean;
  readonly lowerCaseTags: boolean;
  readonly lowerCaseAttributes: boolean;
  readonly recognizeSelfClosing: boolean;
  readonly recognizeCDATA: boolean;
  readonly maxDepth: number;
  readonly maxAttributes: number;
  readonly maxTagLength: number;
}

export interface HTMLDocument {
  readonly documentId: string;
  readonly url: string;
  readonly doctype: string | null;
  readonly root: HTMLElement;
  readonly head: HTMLElement | null;
  readonly body: HTMLElement | null;
  readonly title: string | null;
  readonly charset: string | null;
  readonly language: string | null;
  readonly baseUrl: string | null;
  readonly links: readonly HTMLLink[];
  readonly forms: readonly HTMLForm[];
  readonly scripts: readonly HTMLScript[];
  readonly styles: readonly HTMLStyle[];
  readonly images: readonly HTMLImage[];
  readonly meta: readonly HTMLMeta[];
  readonly comments: readonly HTMLComment[];
}

export interface HTMLElement {
  readonly tagName: string;
  readonly attributes: Readonly<Record<string, string>>;
  readonly children: readonly HTMLNode[];
  readonly textContent: string;
  readonly innerHTML: string;
  readonly outerHTML: string;
  readonly id: string | null;
  readonly className: string | null;
  readonly classList: readonly string[];
  readonly parentElement: HTMLElement | null;
  readonly previousSibling: HTMLNode | null;
  readonly nextSibling: HTMLNode | null;
  readonly depth: number;
  readonly position: ElementPosition;
}

export type HTMLNode = HTMLElement | HTMLTextNode | HTMLComment;

export interface HTMLTextNode {
  readonly type: 'TEXT';
  readonly content: string;
  readonly parentElement: HTMLElement | null;
}

export interface HTMLComment {
  readonly type: 'COMMENT';
  readonly content: string;
  readonly parentElement: HTMLElement | null;
}

export interface ElementPosition {
  readonly startLine: number;
  readonly startColumn: number;
  readonly endLine: number;
  readonly endColumn: number;
  readonly startOffset: number;
  readonly endOffset: number;
}

export interface HTMLLink {
  readonly href: string;
  readonly rel: string | null;
  readonly type: string | null;
  readonly text: string;
  readonly element: HTMLElement;
  readonly isExternal: boolean;
  readonly isAbsolute: boolean;
}

export interface HTMLForm {
  readonly action: string;
  readonly method: string;
  readonly enctype: string;
  readonly name: string | null;
  readonly id: string | null;
  readonly inputs: readonly HTMLInput[];
  readonly selects: readonly HTMLSelect[];
  readonly textareas: readonly HTMLTextarea[];
  readonly buttons: readonly HTMLButton[];
  readonly element: HTMLElement;
}

export interface HTMLInput {
  readonly name: string | null;
  readonly type: string;
  readonly value: string | null;
  readonly placeholder: string | null;
  readonly required: boolean;
  readonly disabled: boolean;
  readonly readonly: boolean;
  readonly maxLength: number | null;
  readonly minLength: number | null;
  readonly pattern: string | null;
  readonly autocomplete: string | null;
  readonly element: HTMLElement;
}

export interface HTMLSelect {
  readonly name: string | null;
  readonly multiple: boolean;
  readonly required: boolean;
  readonly disabled: boolean;
  readonly options: readonly HTMLOption[];
  readonly element: HTMLElement;
}

export interface HTMLOption {
  readonly value: string;
  readonly text: string;
  readonly selected: boolean;
  readonly disabled: boolean;
}

export interface HTMLTextarea {
  readonly name: string | null;
  readonly value: string;
  readonly placeholder: string | null;
  readonly required: boolean;
  readonly disabled: boolean;
  readonly readonly: boolean;
  readonly maxLength: number | null;
  readonly rows: number | null;
  readonly cols: number | null;
  readonly element: HTMLElement;
}

export interface HTMLButton {
  readonly name: string | null;
  readonly type: string;
  readonly value: string | null;
  readonly disabled: boolean;
  readonly text: string;
  readonly element: HTMLElement;
}

export interface HTMLScript {
  readonly src: string | null;
  readonly type: string | null;
  readonly async: boolean;
  readonly defer: boolean;
  readonly integrity: string | null;
  readonly crossOrigin: string | null;
  readonly content: string | null;
  readonly element: HTMLElement;
}

export interface HTMLStyle {
  readonly href: string | null;
  readonly media: string | null;
  readonly content: string | null;
  readonly element: HTMLElement;
}

export interface HTMLImage {
  readonly src: string;
  readonly alt: string | null;
  readonly width: number | null;
  readonly height: number | null;
  readonly loading: string | null;
  readonly element: HTMLElement;
}

export interface HTMLMeta {
  readonly name: string | null;
  readonly property: string | null;
  readonly httpEquiv: string | null;
  readonly content: string | null;
  readonly charset: string | null;
  readonly element: HTMLElement;
}

// ═══════════════════════════════════════════════════════════════════════════════
// NATIVE URL PARSER TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface ParsedURL {
  readonly href: string;
  readonly protocol: string;
  readonly username: string;
  readonly password: string;
  readonly host: string;
  readonly hostname: string;
  readonly port: string;
  readonly pathname: string;
  readonly search: string;
  readonly searchParams: Readonly<Record<string, string | readonly string[]>>;
  readonly hash: string;
  readonly origin: string;
  readonly isAbsolute: boolean;
  readonly isRelative: boolean;
}

// ═══════════════════════════════════════════════════════════════════════════════
// NATIVE JSON PARSER TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface NativeJSONParser {
  readonly parserId: string;
  readonly config: JSONParserConfig;
}

export interface JSONParserConfig {
  readonly strictMode: boolean;
  readonly allowComments: boolean;
  readonly allowTrailingCommas: boolean;
  readonly maxDepth: number;
  readonly maxStringLength: number;
  readonly maxArrayLength: number;
  readonly maxObjectKeys: number;
}

export interface JSONDocument {
  readonly documentId: string;
  readonly root: JSONValue;
  readonly paths: readonly JSONPath[];
}

export type JSONValue =
  | JSONObject
  | JSONArray
  | JSONString
  | JSONNumber
  | JSONBoolean
  | JSONNull;

export interface JSONObject {
  readonly type: 'OBJECT';
  readonly properties: Readonly<Record<string, JSONValue>>;
  readonly path: string;
}

export interface JSONArray {
  readonly type: 'ARRAY';
  readonly items: readonly JSONValue[];
  readonly path: string;
}

export interface JSONString {
  readonly type: 'STRING';
  readonly value: string;
  readonly path: string;
}

export interface JSONNumber {
  readonly type: 'NUMBER';
  readonly value: number;
  readonly path: string;
}

export interface JSONBoolean {
  readonly type: 'BOOLEAN';
  readonly value: boolean;
  readonly path: string;
}

export interface JSONNull {
  readonly type: 'NULL';
  readonly path: string;
}

export interface JSONPath {
  readonly path: string;
  readonly type: 'OBJECT' | 'ARRAY' | 'STRING' | 'NUMBER' | 'BOOLEAN' | 'NULL';
  readonly depth: number;
}

// ═══════════════════════════════════════════════════════════════════════════════
// NATIVE XML PARSER TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface NativeXMLParser {
  readonly parserId: string;
  readonly config: XMLParserConfig;
}

export interface XMLParserConfig {
  readonly strictMode: boolean;
  readonly preserveWhitespace: boolean;
  readonly resolveEntities: boolean;
  readonly validateDTD: boolean;
  readonly maxDepth: number;
  readonly maxAttributes: number;
  readonly maxElementLength: number;
}

export interface XMLDocument {
  readonly documentId: string;
  readonly version: string;
  readonly encoding: string;
  readonly standalone: boolean | null;
  readonly doctype: XMLDoctype | null;
  readonly root: XMLElement;
  readonly namespaces: Readonly<Record<string, string>>;
}

export interface XMLDoctype {
  readonly name: string;
  readonly publicId: string | null;
  readonly systemId: string | null;
  readonly internalSubset: string | null;
}

export interface XMLElement {
  readonly tagName: string;
  readonly localName: string;
  readonly prefix: string | null;
  readonly namespaceURI: string | null;
  readonly attributes: readonly XMLAttribute[];
  readonly children: readonly XMLNode[];
  readonly textContent: string;
  readonly parentElement: XMLElement | null;
  readonly depth: number;
}

export type XMLNode = XMLElement | XMLText | XMLComment | XMLCData | XMLProcessingInstruction;

export interface XMLAttribute {
  readonly name: string;
  readonly localName: string;
  readonly prefix: string | null;
  readonly namespaceURI: string | null;
  readonly value: string;
}

export interface XMLText {
  readonly type: 'TEXT';
  readonly content: string;
}

export interface XMLComment {
  readonly type: 'COMMENT';
  readonly content: string;
}

export interface XMLCData {
  readonly type: 'CDATA';
  readonly content: string;
}

export interface XMLProcessingInstruction {
  readonly type: 'PROCESSING_INSTRUCTION';
  readonly target: string;
  readonly data: string;
}

// ═══════════════════════════════════════════════════════════════════════════════
// PAYLOAD GENERATION TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface PayloadGenerator {
  readonly generatorId: string;
  readonly category: VulnerabilityCategory;
  readonly payloads: readonly GeneratedPayload[];
  readonly config: PayloadGeneratorConfig;
}

export interface PayloadGeneratorConfig {
  readonly maxPayloads: number;
  readonly encodings: readonly PayloadEncoding[];
  readonly evasionTechniques: readonly EvasionTechnique[];
  readonly contextAware: boolean;
  readonly targetSpecific: boolean;
}

export interface GeneratedPayload {
  readonly payloadId: string;
  readonly category: VulnerabilityCategory;
  readonly type: string;
  readonly value: string;
  readonly encoded: string;
  readonly encoding: PayloadEncoding;
  readonly evasion: readonly EvasionTechnique[];
  readonly expectedResponse: ExpectedResponse;
  readonly severity: SeverityLevel;
  readonly description: string;
}

export interface ExpectedResponse {
  readonly type: 'STATUS_CODE' | 'BODY_CONTAINS' | 'BODY_REGEX' | 'HEADER' | 'TIMING' | 'ERROR';
  readonly value: string | number;
  readonly operator: 'EQUALS' | 'CONTAINS' | 'MATCHES' | 'GREATER_THAN' | 'LESS_THAN';
}

// ═══════════════════════════════════════════════════════════════════════════════
// SQL INJECTION PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface SQLInjectionPayloads {
  readonly errorBased: readonly string[];
  readonly unionBased: readonly string[];
  readonly blindBoolean: readonly string[];
  readonly blindTimeBased: readonly string[];
  readonly stackedQueries: readonly string[];
  readonly outOfBand: readonly string[];
  readonly authBypass: readonly string[];
  readonly mysqlSpecific: readonly string[];
  readonly postgresSpecific: readonly string[];
  readonly mssqlSpecific: readonly string[];
  readonly oracleSpecific: readonly string[];
  readonly sqliteSpecific: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// XSS PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface XSSPayloads {
  readonly basic: readonly string[];
  readonly eventHandlers: readonly string[];
  readonly scriptTags: readonly string[];
  readonly imgTags: readonly string[];
  readonly svgTags: readonly string[];
  readonly iframeTags: readonly string[];
  readonly objectTags: readonly string[];
  readonly embedTags: readonly string[];
  readonly linkTags: readonly string[];
  readonly styleTags: readonly string[];
  readonly inputTags: readonly string[];
  readonly formTags: readonly string[];
  readonly bodyTags: readonly string[];
  readonly divTags: readonly string[];
  readonly tableTags: readonly string[];
  readonly videoTags: readonly string[];
  readonly audioTags: readonly string[];
  readonly mathTags: readonly string[];
  readonly detailsTags: readonly string[];
  readonly marqueeTags: readonly string[];
  readonly polyglots: readonly string[];
  readonly domBased: readonly string[];
  readonly angularSpecific: readonly string[];
  readonly reactSpecific: readonly string[];
  readonly vueSpecific: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// COMMAND INJECTION PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface CommandInjectionPayloads {
  readonly basic: readonly string[];
  readonly pipeBased: readonly string[];
  readonly semicolonBased: readonly string[];
  readonly ampersandBased: readonly string[];
  readonly backtickBased: readonly string[];
  readonly dollarBased: readonly string[];
  readonly newlineBased: readonly string[];
  readonly nullByteBased: readonly string[];
  readonly linuxSpecific: readonly string[];
  readonly windowsSpecific: readonly string[];
  readonly blindTimeBased: readonly string[];
  readonly blindOutOfBand: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// PATH TRAVERSAL PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface PathTraversalPayloads {
  readonly basic: readonly string[];
  readonly encoded: readonly string[];
  readonly doubleEncoded: readonly string[];
  readonly unicodeEncoded: readonly string[];
  readonly nullByte: readonly string[];
  readonly linuxTargets: readonly string[];
  readonly windowsTargets: readonly string[];
  readonly wrapperBased: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// SSRF PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface SSRFPayloads {
  readonly localhost: readonly string[];
  readonly ipv4: readonly string[];
  readonly ipv6: readonly string[];
  readonly dnsRebinding: readonly string[];
  readonly cloudMetadata: readonly string[];
  readonly awsMetadata: readonly string[];
  readonly gcpMetadata: readonly string[];
  readonly azureMetadata: readonly string[];
  readonly protocolSmuggling: readonly string[];
  readonly urlBypass: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// TEMPLATE INJECTION PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface TemplateInjectionPayloads {
  readonly detection: readonly string[];
  readonly jinja2: readonly string[];
  readonly twig: readonly string[];
  readonly freemarker: readonly string[];
  readonly velocity: readonly string[];
  readonly smarty: readonly string[];
  readonly mako: readonly string[];
  readonly jade: readonly string[];
  readonly pug: readonly string[];
  readonly ejs: readonly string[];
  readonly handlebars: readonly string[];
  readonly mustache: readonly string[];
  readonly nunjucks: readonly string[];
  readonly thymeleaf: readonly string[];
  readonly razor: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// DESERIALIZATION PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface DeserializationPayloads {
  readonly javaGadgets: readonly string[];
  readonly phpGadgets: readonly string[];
  readonly pythonPickle: readonly string[];
  readonly rubyMarshal: readonly string[];
  readonly dotnetGadgets: readonly string[];
  readonly nodeGadgets: readonly string[];
  readonly yamlGadgets: readonly string[];
  readonly xmlGadgets: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// XXE PAYLOADS
// ═══════════════════════════════════════════════════════════════════════════════

export interface XXEPayloads {
  readonly basic: readonly string[];
  readonly fileRead: readonly string[];
  readonly ssrf: readonly string[];
  readonly blind: readonly string[];
  readonly outOfBand: readonly string[];
  readonly parameterEntities: readonly string[];
  readonly dtdInjection: readonly string[];
  readonly xinclude: readonly string[];
  readonly svgXxe: readonly string[];
  readonly xlsxXxe: readonly string[];
  readonly docxXxe: readonly string[];
}

// ═══════════════════════════════════════════════════════════════════════════════
// SECURITY HEADER ANALYSIS TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface SecurityHeaderAnalysis {
  readonly analysisId: string;
  readonly url: string;
  readonly headers: readonly SecurityHeader[];
  readonly missingHeaders: readonly MissingHeader[];
  readonly misconfiguredHeaders: readonly MisconfiguredHeader[];
  readonly score: number;
  readonly grade: 'A+' | 'A' | 'B' | 'C' | 'D' | 'F';
}

export interface SecurityHeader {
  readonly name: string;
  readonly value: string;
  readonly present: boolean;
  readonly valid: boolean;
  readonly secure: boolean;
  readonly issues: readonly HeaderIssue[];
  readonly recommendations: readonly string[];
}

export interface MissingHeader {
  readonly name: string;
  readonly severity: SeverityLevel;
  readonly description: string;
  readonly recommendation: string;
  readonly reference: string;
}

export interface MisconfiguredHeader {
  readonly name: string;
  readonly value: string;
  readonly issue: string;
  readonly severity: SeverityLevel;
  readonly recommendation: string;
}

export interface HeaderIssue {
  readonly type: 'MISSING' | 'WEAK' | 'MISCONFIGURED' | 'DEPRECATED';
  readonly description: string;
  readonly severity: SeverityLevel;
}

// ═══════════════════════════════════════════════════════════════════════════════
// SSL/TLS ANALYSIS TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface SSLTLSAnalysis {
  readonly analysisId: string;
  readonly host: string;
  readonly port: number;
  readonly certificate: CertificateAnalysis;
  readonly protocols: readonly ProtocolSupport[];
  readonly cipherSuites: readonly CipherSuiteAnalysis[];
  readonly vulnerabilities: readonly SSLVulnerability[];
  readonly score: number;
  readonly grade: 'A+' | 'A' | 'B' | 'C' | 'D' | 'F';
}

export interface CertificateAnalysis {
  readonly subject: string;
  readonly issuer: string;
  readonly serialNumber: string;
  readonly validFrom: number;
  readonly validTo: number;
  readonly daysUntilExpiry: number;
  readonly signatureAlgorithm: string;
  readonly publicKeyAlgorithm: string;
  readonly publicKeySize: number;
  readonly subjectAlternativeNames: readonly string[];
  readonly isValid: boolean;
  readonly isTrusted: boolean;
  readonly isExpired: boolean;
  readonly isSelfSigned: boolean;
  readonly isWildcard: boolean;
  readonly isEV: boolean;
  readonly chainLength: number;
  readonly chainValid: boolean;
  readonly ocspStatus: 'GOOD' | 'REVOKED' | 'UNKNOWN' | 'ERROR';
  readonly ctLogs: readonly string[];
  readonly issues: readonly CertificateIssue[];
}

export interface CertificateIssue {
  readonly type: string;
  readonly severity: SeverityLevel;
  readonly description: string;
}

export interface ProtocolSupport {
  readonly protocol: string;
  readonly version: string;
  readonly supported: boolean;
  readonly secure: boolean;
  readonly deprecated: boolean;
}

export interface CipherSuiteAnalysis {
  readonly name: string;
  readonly protocol: string;
  readonly keyExchange: string;
  readonly authentication: string;
  readonly encryption: string;
  readonly mac: string;
  readonly keySize: number;
  readonly secure: boolean;
  readonly weak: boolean;
  readonly deprecated: boolean;
  readonly forwardSecrecy: boolean;
}

export interface SSLVulnerability {
  readonly name: string;
  readonly cve: string | null;
  readonly severity: SeverityLevel;
  readonly description: string;
  readonly affected: boolean;
  readonly mitigation: string;
}

// ═══════════════════════════════════════════════════════════════════════════════
// CORS ANALYSIS TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface CORSAnalysis {
  readonly analysisId: string;
  readonly url: string;
  readonly corsEnabled: boolean;
  readonly allowOrigin: string | null;
  readonly allowCredentials: boolean;
  readonly allowMethods: readonly string[];
  readonly allowHeaders: readonly string[];
  readonly exposeHeaders: readonly string[];
  readonly maxAge: number | null;
  readonly vulnerabilities: readonly CORSVulnerability[];
  readonly secure: boolean;
}

export interface CORSVulnerability {
  readonly type: CORSVulnerabilityType;
  readonly severity: SeverityLevel;
  readonly description: string;
  readonly evidence: string;
  readonly recommendation: string;
}

export type CORSVulnerabilityType =
  | 'WILDCARD_ORIGIN'
  | 'NULL_ORIGIN'
  | 'REFLECTED_ORIGIN'
  | 'CREDENTIALS_WITH_WILDCARD'
  | 'SUBDOMAIN_WILDCARD'
  | 'INSECURE_PROTOCOL'
  | 'OVERLY_PERMISSIVE';

// ═══════════════════════════════════════════════════════════════════════════════
// CONTENT SECURITY POLICY ANALYSIS TYPES
// ═══════════════════════════════════════════════════════════════════════════════

export interface CSPAnalysis {
  readonly analysisId: string;
  readonly url: string;
  readonly cspHeader: string | null;
  readonly cspReportOnly: string | null;
  readonly directives: readonly CSPDirective[];
  readonly issues: readonly CSPIssue[];
  readonly bypassable: boolean;
  readonly bypassTechniques: readonly string[];
  readonly score: number;
}

export interface CSPDirective {
  readonly name: string;
  readonly values: readonly string[];
  readonly secure: boolean;
  readonly issues: readonly string[];
}

export interface CSPIssue {
  readonly type: CSPIssueType;
  readonly directive: string;
  readonly severity: SeverityLevel;
  readonly description: string;
  readonly recommendation: string;
}

export type CSPIssueType =
  | 'MISSING_DIRECTIVE'
  | 'UNSAFE_INLINE'
  | 'UNSAFE_EVAL'
  | 'WILDCARD_SOURCE'
  | 'HTTP_SOURCE'
  | 'DATA_URI'
  | 'BLOB_URI'
  | 'BASE_URI_MISSING'
  | 'FORM_ACTION_MISSING'
  | 'FRAME_ANCESTORS_MISSING'
  | 'OBJECT_SRC_MISSING'
  | 'SCRIPT_SRC_ELEM_MISSING'
  | 'STYLE_SRC_ELEM_MISSING'
  | 'NONCE_REUSE'
  | 'WEAK_HASH';
